import openai
import json
from api_secrets import API_KEY

openai.api_key = API_KEY

with open('text.txt', 'r') as file:
    messages = file.read()

response = openai.ChatCompletion.create(
    model="gpt-3.5-turbo",
    messages=[
        {
            "role": "user",
            "content": "–í–∞–∫–∞–Ω—Å–∏—è –¥–Ω—è ‚Äî –º–µ–Ω–µ–¥–∂–µ—Ä –ø–æ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–º –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è–º ‚úçüèª\n\n–ß—Ç–æ –Ω—É–∂–Ω–æ –¥–µ–ª–∞—Ç—å: –≤–µ—Å—Ç–∏ –±–ª–æ–≥, —Ä–∞–∑—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –ø–ª–∞–Ω –ø—É–±–ª–∏–∫–∞—Ü–∏–π –∏ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π –¥–ª—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –∏ —Ä–∞–∑–≤–∏–≤–∞—Ç—å –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—É—é –∫—É–ª—å—Ç—É—Ä—É –∏ —Å–≤—è–∑–∏ –≤–Ω—É—Ç—Ä–∏ –∫–æ–º–ø–∞–Ω–∏–∏.\n\n–ß—Ç–æ –∂–¥–µ–º –æ—Ç –≤–∞—Å: –æ–ø—ã—Ç —Ä–∞–±–æ—Ç—ã –≤ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã—Ö –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è—Ö –æ—Ç –≥–æ–¥–∞, –æ–ø—ã—Ç –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π. –ë—É–¥—É—Ç –ø–æ–ª–µ–∑–Ω—ã –Ω–∞–≤—ã–∫–∏ —Ä–∞–±–æ—Ç—ã —Å —Ç–µ–∫—Å—Ç–æ–º, —Ñ–æ—Ç–æ –∏ –≤–∏–¥–µ–æ –∏ –Ω–∞–≤—ã–∫–∏ —Ä–∞–±–æ—Ç—ã —Å –±—é–¥–∂–µ—Ç–æ–º.\n\n–ü–æ—á–µ–º—É —Å—Ç–æ–∏—Ç –æ—Ç–∫–ª–∏–∫–Ω—É—Ç—å—Å—è: –¥–æ—Å—Ç–æ–π–Ω—ã–π –¥–æ—Ö–æ–¥ –∏ –±–æ–Ω—É—Å –≤ –∫–æ–Ω—Ü–µ –≥–æ–¥–∞, —Ä–∞–±–æ—Ç–∞ –∏–∑ –¥–æ–º–∞ –∏ –≤ –º–æ—Å–∫–æ–≤—Å–∫–æ–º –æ—Ñ–∏—Å–µ —É –º. ¬´–î–º–∏—Ç—Ä–æ–≤—Å–∫–∞—è¬ª, 5/2 —Å 09:00 –¥–æ 18:00, –î–ú–°, –∫—Ä—É—Ç—ã–µ –∫–æ–ª–ª–µ–≥–∏ –∏ –Ω–∞—Å—Ç–∞–≤–Ω–∏–∫–∏ –∏ –º–Ω–æ–≥–æ –¥—Ä—É–≥–∏—Ö –±–æ–Ω—É—Å–æ–≤."
        },
        {
            "role": "system",
            "content": "–ó–∞–¥–∞—á–∞ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∏ –∏–∑–≤–ª–µ—á—å –ø–æ–ª–µ–∑–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Å–æ–∏—Å–∫–∞—Ç–µ–ª–µ–π, —Ç–∞–∫ —á—Ç–æ–±—ã –º–æ–∂–Ω–æ –±—ã–ª–æ —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –∏ –±—ã—Å—Ç—Ä–æ –Ω–∞—Ö–æ–¥–∏—Ç—å –Ω—É–∂–Ω—ã–µ –≤–∞–∫–∞–Ω—Å–∏–∏"
        }
    ],
    temperature=0.7,
    functions=[
        {
            "name": "extract_data",
            "description": "–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Ç–µ–∫—Å—Ç–∞ –≤–∞–∫–∞–Ω—Å–∏–∏",
            "parameters": {
                "type": "object",
                "properties": {
                    "location": {
                        "type": "string",
                        "description": "–ú–µ—Å—Ç–æ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏—è –≤–∞–∫–∞–Ω—Å–∏–∏. –≠—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –≥–æ—Ä–æ–¥, —Å—Ç—Ä–∞–Ω–∞. –ú–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç—ã–º"
                    },
                    "position": {
                        "type": "string",
                        "description": "–≠—Ç–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∞—è –¥–æ–ª–∂–Ω–æ—Å—Ç—å –∏–ª–∏ —Ä–æ–ª—å, –∫–æ—Ç–æ—Ä—É—é –∑–∞–π–º–µ—Ç –∫–∞–Ω–¥–∏–¥–∞—Ç"
                    },
                    "tags": {
                        "type": "array",
                        "description": "–≠—Ç–æ –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ –∏–ª–∏ —Ñ—Ä–∞–∑—ã, –∫–æ—Ç–æ—Ä—ã–µ –æ–ø–∏—Å—ã–≤–∞—é—Ç –æ–±—â–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –≤–∞–∫–∞–Ω—Å–∏–∏. –û–Ω–∏ –ø–æ–º–æ–≥–∞—é—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≤–∞–∫–∞–Ω—Å–∏—é –∏ —É–ø—Ä–æ—â–∞—é—Ç –ø–æ–∏—Å–∫ –¥–ª—è —Å–æ–∏—Å–∫–∞—Ç–µ–ª–µ–π",
                        "items": {
                            "type": "string",
                            "enum": [
                                "FULL_TIME",
                                "PART_TIME",
                                "INTERNSHIP",
                                "FREELANCE",
                                "ON_SITE",
                                "VOLUNTEER",
                                "REMOTE",
                                "TEMPORARY",
                                "CONTRACT",
                                "FLEXIBLE_HOURS",
                                "HYBRID",
                                "NO_EXPERIENCE",
                                "ENTRY_LEVEL",
                                "EXPERIENCED"
                            ]
                        }
                    },
                    "title": {
                        "type": "string",
                        "description": "–≠—Ç–æ —É–Ω–∏–∫–∞–ª—å–Ω–æ–µ –∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –≤–∞–∫–∞–Ω—Å–∏–∏, –∫–æ—Ç–æ—Ä–æ–µ —Å—Ä–∞–∑—É –∂–µ –¥–∞–µ—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –æ –¥–æ–ª–∂–Ω–æ—Å—Ç–∏ –∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è—Ö. –û–Ω–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —è—Å–Ω—ã–º –∏ –æ—Ç—Ä–∞–∂–∞—Ç—å —Å—É—Ç—å –≤–∞–∫–∞–Ω—Å–∏–∏."
                    }
                },
                "required": [
                    "title",
                    "position",
                    "tags"
                ]
            }
        }
    ],
    function_call="auto"
)

function = response.choices[0].message.get('function_call')

if function is not None:
    data = function.arguments
    data_dict = json.loads(data)
    print(json.dumps(data_dict, indent=4, ensure_ascii=False))